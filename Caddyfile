:80 {
    root * /srv

    # MUST BE FIRST - match API before SPA fallback
    handle /api/* {
        reverse_proxy backend:3000
    }

    handle /trpc/* {
        reverse_proxy backend:3000
    }

    # Serve static files
    file_server

    # Fallback SPA for all other routes
    handle {
        try_files {path} /index.html
    }
}
